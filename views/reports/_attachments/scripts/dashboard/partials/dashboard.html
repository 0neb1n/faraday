<!-- Faraday Penetration Test IDE &#45; Community Version -->
<!-- Copyright (C) 2013  Infobyte LLC (http://www.infobytesec.com/) -->
<!-- See the file 'doc/LICENSE' for the license information -->
    
<section id="main" class="seccion clearfix">
    <div class="right-main">
        <div id="reports-main" class="fila clearfix">
            <h2 class="ws-label">
                <span id="ws-name" class="label label-default"
                        title="Current workspace">Dashboard for {{ workspace }}</span><!-- WS name -->
                <div id="ws-control" class="btn-group">
                    <button id="refresh" type="button" class="btn btn-danger" title="Refresh current workspace" ng-click="location.reload()">
                        <span class="glyphicon glyphicon-refresh"></span>
                    </button>
                    <button type="button" class="btn btn-danger dropdown-toggle" data-toggle="dropdown" title="Change current workspace">
                        Change workspace <span class="caret"></span>
                    </button>
                    <ul id="nav" class="dropdown-menu dropdown-menu-right" role="menu">
                        <li ng-repeat="ws in workspaces"><a href="#/dashboard/ws/{{ws}}" class="ws" >{{ws}}</a></li>
                    </ul><!-- WS navigation -->
                </div><!-- #ws-control -->
            </h2><!-- .ws-label -->
            <div class="reports">
            </div><!-- .reports -->
            <div ng-controller="graphicsBarCtrl" ng-include="'scripts/dashboard/partials/graphics-bar.html'"></div>
            <div ng-controller="sumarizedCtrl" ng-include="'scripts/dashboard/partials/sumarized.html'"></div>

        </div><!-- #reports-main -->
    </div><!-- .right-main -->
</section>
<script type="text/javascript">
$(document).ready(function() {
    //get workspace
    domain = location.href;
    space = domain.split("#");
    workspace = space[1];

    $(document).on("click", "a.treemap-view", function(e) {
        e.preventDefault();
        var url = "../././reports/treemap.html?workspace=" + workspace +"&design=hosts&view=byservices#"+ workspace;
        window.location.href = url;
    });

    rutas = [
        "reports/compound.html?workspace="+workspace+"&design=hosts&view=compound",
        "reports/byservices.html?workspace="+workspace+"&design=hosts&view=byservices",
        "reports/summarized.html?workspace="+workspace+"&design=hosts&view=summarized",
        "reports/vulns.html?workspace="+workspace+"&design=hosts&view=vulns",
        "reports/commands.html?workspace="+workspace+"&design=commands&view=list"
    ];
    // var content_cake = "<div id='sequence'></div><div id='chart'><div id='explanation' style='visibility: hidden;'></div></div>";

    // $("#reports-main").append("<div class='col-lg-2'><article id='treemap' class='panel panel-default'><header>"+
    //     "<h2><a class=\"treemap-view\" href=\"\">Top Services</a> <span class=\"glyphicon glyphicon-info-sign faraday-qtips\" title=\"Top 5 services with the largest quantity of hosts\">"+
    //     "</span></h2></header></article></div>"+
    //     "<div class='col-lg-2'><article id='bar' class='panel panel-default'><header><h2>Top Hosts "+
    //     "<span class=\"glyphicon glyphicon-info-sign faraday-qtips\" title=\"Top 3 hosts with the largest quantity of services\"></span></h2></header></article></div>"+
    //     "<div class='col-lg-2'><article id='cake' class='panel panel-default'><header><h2>Vulnerabilities "+
    //     "<span class=\"glyphicon glyphicon-info-sign faraday-qtips\" title=\"Vulnerabilty distribution for current WS\"></span></h2>"+
    //     "</header>"+ content_cake +"</article></div>"+
    //     "<div id='byservices'></div><div id='summarized'></div>"+
    //     "<div id='compound'></div><div id='vulns'></div><div id='list'></div>");

    // design = "hosts";
    // view = "byservices";
    // treemap(workspace, design, view);
    // bar(workspace, design, view);
    // view = "vulns";
    // cake(workspace, design, view);
    // for (i = 0; i < rutas.length; i++) { 
    //     domain = rutas[i];
    //     var div = load(domain);
    // }

    // var navegador = navigator.userAgent;
    // if (navigator.userAgent.indexOf('MSIE') !=-1) {
    //     $("#main.seccion").height(screen.height - 100);
    // } else if (navigator.userAgent.indexOf('Firefox') !=-1) {
    //     $("#main.seccion").height(screen.height - 100);
    // } else if (navigator.userAgent.indexOf('Chromium') !=-1) {
    //     $("#main.seccion").height(screen.height - 100);
    // } else if (navigator.userAgent.indexOf('Chrome') !=-1) {
    //     $("#main.seccion").height(screen.height - 100);
    // } else if (navigator.userAgent.indexOf('Opera') !=-1) {
    //     $("#main.seccion").height(screen.height - 100);
    // }

    // $('#cont').on('mouseenter', '.faraday-qtips', function (event) {
    //     $(this).qtip({
    //         overwrite: false, // Don't overwrite tooltips already bound
    //         show: {
    //             event: event.type, // Use the same event type as above
    //             ready: true // Show immediately - important!
    //         },
    //         hide: {
    //             fixed: true,
    //             delay: 300
    //         },
    //         content:{
    //             text: function(event, api) {
    //                 var res = "<div id=\"contenido\">"+$(this).attr("title")+"</div>";
    //                 return res;
    //             }
    //         },
    //         position:{
    //             my: 'top center',
    //             at: 'bottom center',
    //             adjust: {
    //                 method: 'shift'
    //             }
    //         }
    //     });
    // });
});

// function load(domain){
//     $(".reports").load(domain, function(){
//         var parametros = domains(domain);
//             var div = get_report_div(parametros[0],parametros[1],parametros[2]);
//             if(parametros[1] == "byservices"){
//                 $("#byservices").append(div);
//             }
//             if(parametros[1] == "summarized"){
//                 $("#summarized").append(div);
//             }
//             if(parametros[1] == "vulns"){
//                 $("#vulns").append(div);
//             }
//             if(parametros[1] == "list"){
//                 $("#list").append(div);
//             }
//             if(parametros[1] == "compound"){
//                 $("#compound").append(div);
//             }
//     });
// }

// function domains(domain){
// //get the link parameters
//     space = domain.split("=");
//     workspace = space[1].split("&");
//     workspace = workspace[0];
//     design = space[2].split("&");
//     design = design[0];
//     view = space[3];
//     parametros = [workspace, view, design];
//     return parametros;
// }

// setTimeout(function() {
//     //order of compound when reload
//     sorter(0);
// }, 1000);
</script>
